/*! pull-load-0.0.1 2017-02-10 By Males */!function(a,b){function c(a,b,c){b.addEventListener(a,function(a){c(a)})}function d(){var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAACgCAMAAACsXRuGAAAAt1BMVEX////FxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcU7SVrkAAAAPHRSTlMAAPONxyCMRvCjM2n59gzeD/xssVo52Akwh6sDpeTbckJLZroqfhUnRernVxifG9XDgb2ZzzxjeLThEmBcLCjmAAACDklEQVR4Xu2Y124yQQyFM9sh9BJafgik956/7fs/V4RCwiITbMdjCSGfKy4On7THnuLZ8yGTyRWUr1W54NgNIC4Dbm+VrQ+tbQxoQAMa0IAGnO4vtR44WBquCcBuJadrSslwQucNaBm2qbyHEQ3YqNN4l3fUKpdpMV7Q26ZF4T3S+5AU49OIA8RjvLpxDCAeY/PIcYB4jKf8tTzcxDt2fGBt/D3v19kPgK5fRQLkAt0MCZANdIdIgGxg7WBjgHygO1kTY/NVMla8QeBvJwHCGP84CRDG+PefBAhjrHTlo9n/InDiY9a7XfLazgewd//Jqze8AN15sAiw7Gu87XwAW/7m5ec5b+j8AXsveT6uSYAwxmrf7xNBZ+aYQJPJZDLh+20aRlkWhen8twdgnCyO0SCJfQDjUv6lUuwBmOQFJXJgGhSBQSoGhvmKQnFNo1VgBD3MmmarwAx6WDWFQOhh1RR+MvSwagqLwqw7/ndW3UkfCD2bhJcAephAvJGYn4y3OrMouIfZNriH19i4h7v0cI9ww4ce4ZEEPTt6/uJ+UdS4H28G1C9qV9yPLyjUL1vyuB/dlLh+dNtE/dpA+SdrF0XeNsqNLV96+puDfPvaaukfUvJjVP+gl19F9C9L8uuc/oVTfiXWv7TLxwr9wUc+msmHR/3xVj6A6z8RSBej/jMLp+76T1X6j2m7eP6aTO9STHV4CXebKAAAAABJRU5ErkJggg==",b='.pull-load-container {\tdisplay: -webkit-box;\tdisplay: -ms-flexbox;\tdisplay: flex;\t-webkit-box-pack: center;\t-ms-flex-pack: center;\tjustify-content: center;\t-webkit-box-align: center;\t-ms-flex-align: center;\talign-items: center;\tfont-size: 14px;\toverflow: hidden}.pull-load-down, .pull-load-up, .pull-load-empty-data {\tbackground:transparent;\tline-height:40px;\tpadding:0px 10px;\tfont-weight:bold;\tfont-size:14px;\tcolor:#888;}.pull-load-down .pull-load-down-icon, .pull-load-up .pull-load-up-icon  {\tdisplay: inline-block;\tvertical-align: middle;\tmargin-bottom: 5px;\twidth: 20px;\theight: 20px;\tbackground:url("'+a+'") 0 0 no-repeat;\t-webkit-background-size:cover; background-size:cover;\t-webkit-transition-property:-webkit-transform;\t-webkit-transition-duration:250ms;}.pull-load-down .pull-load-down-icon {\t-webkit-transform:rotate(0deg) translateZ(0);}.pull-load-up .pull-load-up-icon  {\t-webkit-transform:rotate(-180deg) translateZ(0);}.pull-load-down.pull-load-flip .pull-load-down-icon {\tfont-size: 14px;\t-webkit-transform:rotate(-180deg) translateZ(0);}.pull-load-up.pull-load-flip .pull-load-up-icon {\tfont-size: 14px;\t-webkit-transform:rotate(0deg) translateZ(0);}.pull-load-down.pull-load-loading .pull-load-down-icon, .pull-load-up.pull-load-loading .pull-load-up-icon {\tbackground-position:0 100%;\t-webkit-transform:rotate(0deg) translateZ(0);\t-webkit-transition-duration:0ms;\t-webkit-animation-name:loading;\t-webkit-animation-duration:2s;\t-webkit-animation-iteration-count:infinite;\t-webkit-animation-timing-function:linear;}@-webkit-keyframes loading {\tfrom { -webkit-transform:rotate(0deg) translateZ(0); }\tto { -webkit-transform:rotate(360deg) translateZ(0); }}',c="__pull_load_css",d=g.getElementById(c);d&&d.parentNode&&d.parentNode.removeChild(d),d=g.createElement("style"),d.id=c,d.type="text/css",d.styleSheet?d.styleSheet.cssText=b:d.innerHTML=b,g.getElementsByTagName("head")[0].appendChild(d)}function e(a){this.isTouchWebkit="ontouchstart"in f&&"WebKitCSSMatrix"in f,this.container=a.container,this.scrollBar=a.scrollBar,this.touchstart="touchstart",this.touchmove="touchmove",this.touchend="touchend",this.isTouchWebkit||(this.touchstart="mousedown",this.touchmove="mousemove",this.touchend="mouseup"),this.down=Object.assign({},{el:null,distance:50,container:'<div class="pull-load-container"></div>',init:'<div class="pull-load-down"><span><span class="pull-load-down-icon"></span>下拉刷新...</span></div>',loading:'<div class="pull-load-down pull-load-loading"><span class="pull-load-down-icon"></span>刷新中...</span></div>',release:'<div class="pull-load-down pull-load-flip"><span><span class="pull-load-down-icon"></span>释放刷新...</span></div>',emptyData:'<div class="pull-load-empty-data">没有更多数据了</div>',id:"_____pull_down____",enable:!0,callback:null},a.down?a.down:{}),this.up=Object.assign({},{el:null,distance:50,container:'<div class="pull-load-container"></div>',init:'<div class="pull-load-up"><span><span class="pull-load-up-icon"></span>上拉加载更多...</span></div>',loading:'<div class="pull-load-up pull-load-loading"><span class="pull-load-up-icon"></span>加载中...</span></div>',release:'<div class="pull-load-up pull-load-flip"><span><span class="pull-load-up-icon"></span>释放加载...</span></div>',emptyData:'<div class="pull-load-empty-data">没有更多数据了</div>',id:"_____pull_up____",enable:!0,isScrollLoad:!1,isInitLoad:!1,callback:null},a.up?a.up:{}),this.baseRefreshContainer='<div class="pull-load-container"></div>',this.startY=0,this.moveY=0,this.elStartY=-1,this.startScrollTop=0,this.bottomDiff=0,this.topDiff=0,this.type="",this.canRefresh=!1,this.canLoadMore=!1,this.isTouchStart=!1,this.isLoading=!1,this.isEmptyData=!1,this.hasInsertDom=!1,this.scrollLoadHasInsertDom=!1,d(),this.init()}var f=a,g=b;e.prototype={constructor:e,init:function(){var a=this,b=a.container;if(b&&(a.scrollBar||(a.scrollBar=b),a.up.isInitLoad?(a.createDiv(a.up,!0,!0),a.upLoadMore(!0)):a.up.isScrollLoad&&a.createDiv(a.up,!0,!0),c(a.touchstart,b,function(){a.touch(event)}),c(a.touchmove,b,function(){a.touch(event)}),c(a.touchend,b,function(){a.touch(event)}),c("scroll","body"===a.scrollBar.tagName.toLowerCase()?f:a.scrollBar,function(){a.scroll(event)}),!a.isTouchWebkit)){var d="body"===a.scrollBar.tagName.toLowerCase()?document:a.scrollBar;d.onselectstart=function(){return!1},d.onselect=function(){g.selection.empty()},g.addEventListener(a.touchend,function(){a.touch(event)},!1)}},scroll:function(a,b,c){var d=this,e=d.up;if(!e.enable)return!1;var f=d.container,g=d.scrollBar;if(e.isScrollLoad&&!d.isLoading){var h=d.elPos(g).bottom,i=d.elPos(f).bottom;d.bottomDiff=h-i;var j=0;if(j="body"===g.tagName.toLowerCase()?d.getScrollHeight()-(d.getScrollTop()+d.getWindowHeight()):g.scrollHeight-(g.scrollTop+g.clientHeight),j-=d.bottomDiff,e.init&&j-e.distance<0&&!d.scrollLoadHasInsertDom&&d.createDiv(e,!0),b&&!d.isTouchWebkit){var k=Math.abs(c);g.scrollTop=d.startScrollTop+k}e.el&&j<=0&&d.upLoadMore()}},touch:function(a){var b=this,c=b.scrollBar;switch(a=a||f.event,a.stopPropagation(),a.type){case b.touchstart:b.startY=b.pos(a).y,b.startScrollTop="body"===c.tagName.toLowerCase()?b.getScrollTop():c.scrollTop,b.type="",b.isTouchStart=!0,b.isLoading||(b.isLoading=!1,b.canRefresh=!1,b.canLoadMore=!1,b.hasInsertDom=!1,b.elStartY=-1);break;case b.touchmove:if(b.isTouchStart){if(!b.isTouchWebkit&&0===a.buttons)return!1;b.moveY=b.pos(a).y;var d=b.moveY-b.startY;if(b.type){if(!b.isLoading){var e=b.moveY-b.startY,g="body"===c.tagName.toLowerCase()?b.getScrollTop():c.scrollTop;if("up"===b.type&&e>0||"down"===b.type&&e<0)return b.startY=b.pos(a).y,b.startScrollTop=g,b.hasInsertDom=!1,b.elStartY=-1,"up"===b.type?(b.type="down",b.up.el&&b.up.el.parentNode&&(b.up.el.parentNode.removeChild(b.up.el),b.up.el=null)):(b.type="up",b.down.el&&b.down.el.parentNode&&(b.down.el.parentNode.removeChild(b.down.el),b.down.el=null)),!1}}else d<0?b.type="up":d>0&&(b.type="down");switch(b.type){case"up":b.up.isScrollLoad?b.scroll(a,!0,d):b.upAction(a,d);break;case"down":b.downAction(a,d)}}break;case b.touchend:b.end(b.type,b.canRefresh,b.canLoadMore)}},end:function(a,b,c){var d=this;if(d.isTouchStart=!1,b)d._end(d.down,!1,c,b);else if(c)d._end(d.up,!0,c,b);else if(!d.isLoading)switch(a){case"up":d.back(d.up,!0);break;case"down":d.back(d.down,!1)}},_end:function(a,b,c,d){var e=this;return(!b||!a.isScrollLoad)&&void(b&&c||!b&&d?(e.setCan(b,!1),e.setHeight(a.el,a.distance),e.transition(a.el,.5),a.el&&(a.el.innerHTML=a.loading),e.isLoading=!0,a.callback&&a.callback(function(c){e.isEmptyData=c,e.back(a,b)})):e.back(a,b))},back:function(a,b){var d=this;if(b){if(a.isScrollLoad)return!1}else;if(a.el){if(d.isEmptyData)return a.el.innerHTML=a.emptyData,a.enable=!1,d.isLoading=!1,!1;a.el.innerHTML=a.init,d.setHeight(a.el,0),d.transition(a.el,.5),c("webkitTransitionEnd",a.el,function(a){d.transitionEnd(a.target,b)}),c("transitionend",a.el,function(a){d.transitionEnd(a.target,b)})}},upAction:function(a,b){var c=this,d=c.container,e=c.scrollBar,f=c.up;if(!f.enable||!f.init)return!1;var g="body"===e.tagName.toLowerCase()?c.getScrollTop():e.scrollTop,h=Math.abs(b),i=c.elPos(e).bottom,j=c.elPos(d).bottom;c.bottomDiff=i-j;var k=0;if(k="body"===e.tagName.toLowerCase()?c.getScrollHeight()-(g+c.getWindowHeight()):e.scrollHeight-(g+e.clientHeight),b>0&&0===g)return!1;if(c.isLoading)return e.scrollTop=h+c.startScrollTop,!1;k-=c.bottomDiff,f.init&&k-f.distance<0&&!c.hasInsertDom&&c.createDiv(f,!0);var l=Math.abs(f.distance);if(f.el){k<5&&c.elStartY<0&&(c.elStartY=c.pos(a).y);var m=Math.abs(c.pos(a).y-c.elStartY);(c.elStartY<0||c.pos(a).y>c.elStartY)&&(m=0),a.cancelable&&a.preventDefault();var n=c.updateElInfo(f,!0,m,l);f.el.innerHTML=n.innerHtml,!c.isScrollLoad&&0===e.scrollTop&&n.offsetY>=f.distance&&(n.offsetY=f.distance),c.setHeight(f.el,n.offsetY),e.scrollTop=h+c.startScrollTop}else c.isTouchWebkit||(e.scrollTop=h+c.startScrollTop)},downAction:function(a,b){var c=this,d=c.container,e=c.scrollBar,f=c.down;if(!f.enable||!f.init)return!1;var g="body"===e.tagName.toLowerCase()?c.getScrollTop():e.scrollTop,h=c.elPos(e).top,i=c.elPos(d).top;c.topDiff=i-h;var j=g-c.topDiff,k=Math.abs(b);if(j>0)return c.isTouchWebkit||(e.scrollTop=c.startScrollTop-k),!1;if(c.isLoading)return e.scrollTop=c.startScrollTop-k,!1;c.hasInsertDom||c.createDiv(f,!1);var l=Math.abs(f.distance);if(f.el){j<=0&&c.elStartY<0&&(c.elStartY=c.pos(a).y);var m=Math.abs(c.pos(a).y-c.elStartY);(c.elStartY<0||c.pos(a).y<c.elStartY)&&(m=0),a.cancelable&&a.preventDefault();var n=c.updateElInfo(f,!1,m,l);f.el.innerHTML=n.innerHtml,c.setHeight(f.el,n.offsetY)}},updateElInfo:function(a,b,c,d){var e=this,f=a.init,g=0;return e.canRefresh=!1,e.canLoadMore=!1,c<=d?(g=c,f=a.init,e.setCan(b,!1)):c>d&&c<=2*d?(g=d+.5*(c-d),f=a.release,e.setCan(b,!0)):(g=d+.5*d+.2*(c-2*d),f=a.release,e.setCan(b,!0)),{innerHtml:f,offsetY:g}},upLoadMore:function(a){var b=this,c=b.up;c.el&&!b.isLoading&&(c.el.innerHTML=c.loading,b.isLoading=!0,c.callback&&c.callback(function(d){b.isLoading=!1,b.isEmptyData=d,c.el&&(d?(c.el.innerHTML=c.emptyData,c.enable=!1):c.el.innerHTML=c.init),a&&!c.isScrollLoad&&b.back(c,!0)}))},createDiv:function(a,b,d){var e=this,f=e.container;if(a.el=null,a.init){d?e.scrollLoadHasInsertDom=!0:e.hasInsertDom=!0;var h=g.createElement("div");a.container?h.innerHTML=a.container:h.innerHTML=e.baseRefreshContainer,a.el=h.childNodes[0],a.el.id||(a.el.id=a.id),a.el.innerHTML=a.init,a.el.id+=e.randomString(6),a.id=a.el.id;var i=g.getElementById(a.id);i&&i.parentNode&&i.parentNode.removeChild(i),e.setHeight(a.el,b?a.distance:0),b?(f.appendChild(a.el),d&&c("click",a.el,function(){!e.isLoading&&a.enable&&e.upLoadMore()})):e.prependChild(f,a.el)}},setCan:function(a,b){var c=this;a?c.canLoadMore=b:c.canRefresh=b},pos:function(a){if(this.isTouchWebkit)return a.touches||(a.touches=a.originalEvent.touches),{x:a.touches[0].clientX,y:a.touches[0].clientY};a=a||f.event;var b=g.documentElement;return{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}},elPos:function(a){var b=a.getBoundingClientRect(),c=document.documentElement.clientTop,d=document.documentElement.clientLeft;return{top:b.top-c,bottom:b.bottom-c,left:b.left-d,right:b.right-d}},getScrollTop:function(){var a=0,b=0,c=0;return document.body&&(b=document.body.scrollTop),document.documentElement&&(c=document.documentElement.scrollTop),a=b-c>0?b:c},getScrollHeight:function(){var a=0,b=0,c=0;return document.body&&(b=document.body.scrollHeight),document.documentElement&&(c=document.documentElement.scrollHeight),a=b-c>0?b:c},getWindowHeight:function(){var a=0;return a="CSS1Compat"===document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},setHeight:function(a,b){a&&(a.style.height=b+"px")},transition:function(a,b){a&&(a.style.transition="transform "+b+"s ease-out",a.style.webkitTransition="-webkit-transform "+b+"s ease-out",a.style.transitionProperty="height",a.style.webkitTransitionProperty="height")},transitionEnd:function(a,b){var c=this;c.isLoading=!1,a.parentNode&&a.parentNode.removeChild(a),b?c.up.el=null:c.down.el=null},randomString:function(a){a=a||32;var b="ABCDEFGHIJKLMNOPQRSTVUWXYZabcdefghijklmnopqrstvuwxyz0123456789",c=b.length,d="";for(i=0;i<a;i++)d+=b.charAt(Math.floor(Math.random()*c));return d},prependChild:function(a,b){a.hasChildNodes()?a.insertBefore(b,a.firstChild):a.appendChild(b)}},"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define([],function(){return e}):f.PullLoad=e}(window,document);